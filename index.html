<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Search Products</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(to right, #ece9e6, #ffffff); margin: 0; padding: 40px 20px; display: flex; flex-direction: column; align-items: center; }
    h1 { font-size: 2.5rem; color: #333; margin-bottom: 20px; }
    #searchBox { padding: 12px 20px; font-size: 18px; border: 2px solid #ccc; border-radius: 10px; width: 90%; max-width: 500px; margin-bottom: 30px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .product-list { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; max-width: 1200px; }
    .product { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 280px; text-align: center; transition: transform 0.2s; }
    .product:hover { transform: translateY(-5px); }
    .product img { max-width: 100%; height: auto; margin-bottom: 15px; border-radius: 8px; }
    .buy-btn { background: #ff4747; color: white; padding: 10px 15px; text-decoration: none; border-radius: 5px; font-weight: bold; display: inline-block; margin-top: 10px; }
    .error { color: #b00; margin-top: 20px; }
    .loading { color: #555; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Find Your Product</h1>
  <input type="text" id="searchBox" placeholder="Search product code..." disabled />
  <div id="result" class="product-list"></div>

  <script>
    // Your published sheet ID (publish via File > Publish to web)
    const sheetId = '1BQ6p45t85l9vi05NW_orX38P2f1fkLiEF65qyRLlb_o';
    const sheetURL = `https://opensheet.elk.sh/${sheetId}/Sheet1`;
    let products = [];
    const input = document.getElementById('searchBox');
    const resultDiv = document.getElementById('result');

    // Fetch all products on load and display
    window.addEventListener('DOMContentLoaded', async () => {
      resultDiv.innerHTML = '<p class="loading">Loading product data...</p>';
      try {
        const res = await fetch(sheetURL);
        products = await res.json();
        if (!Array.isArray(products)) throw new Error('Invalid data');
        input.disabled = false;
        renderProducts(products);
      } catch (err) {
        resultDiv.innerHTML = `<p class="error">Error loading products: ${err.message}</p>`;
      }
    });

    // Render a list of products
    function renderProducts(list) {
      if (list.length) {
        resultDiv.innerHTML = list.map(item => `
          <div class="product">
            <h3>${item['Name'] || 'Unnamed Product'}</h3>
            <img src="${item['Image URL'] || ''}" alt="${item['Name']}" />
            <a class="buy-btn" href="${item['AliExpress Link'] || '#'}" target="_blank">Buy on AliExpress</a>
          </div>
        `).join('');
      } else {
        resultDiv.innerHTML = '<p class="error">No products available.</p>';
      }
    }

    // Filter on user input
    input.addEventListener('input', function() {
      const keyword = this.value.trim().toUpperCase();
      if (!keyword) return renderProducts(products);
      const matches = products.filter(item => item['Product Code'] && item['Product Code'].toUpperCase().includes(keyword));
      if (matches.length) renderProducts(matches);
      else resultDiv.innerHTML = `<p class="error">No product found for: <strong>${keyword}</strong></p>`;
    });
  </script>
</body>
</html>
